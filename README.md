# AI-Native SDLC

> Automate your software development lifecycle with GitHub Copilot CLI in GitHub Actions

[![GitHub Actions](https://img.shields.io/badge/GitHub-Actions-blue?logo=github-actions)](https://github.com/features/actions)
[![Copilot](https://img.shields.io/badge/GitHub-Copilot-purple?logo=github)](https://github.com/features/copilot)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)

## ğŸš€ Overview

AI-Native SDLC demonstrates how to integrate GitHub Copilot CLI directly into your CI/CD pipelines using GitHub Actions. This repository showcases automated code generation workflows that create pull requests with AI-generated code based on natural language prompts.

## âœ¨ Features

- ğŸ¤– **Automated Code Generation**: Generate production-ready Python code using natural language prompts
- ğŸ”„ **Pull Request Automation**: Automatically creates feature branches and PRs with generated code
- ğŸ” **GitHub App Integration**: Secure authentication using GitHub Apps for `gh agent-task` automation
- ğŸ“ **Interactive Q&A**: Query documentation and get answers saved to markdown files
- ğŸ¯ **Zero Configuration**: Works out of the box with GitHub Actions
- ğŸ·ï¸ **Smart Labeling**: Automatically tags PRs with `ai-generated` and `needs-review` labels

## ğŸ“‹ Prerequisites

- GitHub repository with Actions enabled
- GitHub Copilot subscription
- Personal Access Token (PAT) with Copilot scope

## ğŸ› ï¸ Setup

### 1. Configure Repository Settings

1. Go to `Settings` â†’ `Actions` â†’ `General`
2. Under **Workflow permissions**, select:
   - âœ… **Read and write permissions**
   - âœ… **Allow GitHub Actions to create and approve pull requests**

### 2. Add Secrets

âš ï¸ **Important Note about `gh agent-task` in GitHub Actions:**

The `gh agent-task create` command requires an **OAuth token** (prefix `gho_`), not a standard Personal Access Token (prefix `github_pat_` or `ghp_`). 

**Current Limitation:** `gh agent-task` cannot be fully automated in GitHub Actions with PAT tokens. The command works best when run locally or requires a GitHub App for automation.

**For local usage:**
1. Authenticate with `gh auth login` (creates OAuth token)
2. Run `gh agent-task create "your task description"`

**For CI/CD automation with `gh agent-task`:**
- ğŸ¯ **Recommended:** Use GitHub App authentication
- ğŸ“– **Complete Guide:** [GitHub App Setup](docs/github-app-setup.md)
- âš¡ **Workflow:** [copilot-agent-github-app.yml](.github/workflows/copilot-agent-github-app.yml)

**Alternative approaches:**
- Use other Copilot workflows in this repo that work with PAT tokens

If you still want to try with PAT:
1. Create a [Personal Access Token](https://github.com/settings/tokens/new) with these scopes:
   - `repo` (Full control of private repositories)
   - `workflow` (Update GitHub Actions workflows)

2. Add to repository secrets as `COPILOT_TOKEN`:
   ```
   Settings â†’ Secrets and variables â†’ Actions â†’ New repository secret
   Name: COPILOT_TOKEN
   Value: <your-token>
   ```

### 3. Create Labels

Run these commands in your repository:
```bash
gh label create "ai-generated" --description "Code generated by AI" --color "0E8A16"
gh label create "needs-review" --description "Requires code review" --color "FBCA04"
```

## ğŸ’» Usage

### Copilot Feature Development Workflow

Generate code and create a pull request automatically:

```bash
gh workflow run copilot-feature-dev.yml \
  -f feature_prompt="Create a function to calculate Fibonacci numbers"
```

**What it does:**
1. Creates a new feature branch
2. Generates Python code using GitHub Copilot CLI
3. Commits code to the branch
4. Creates a pull request with generated code
5. Adds appropriate labels for review

**Example prompts:**
```bash
# Generate a calculator function
gh workflow run copilot-feature-dev.yml \
  -f feature_prompt="Create a calculator class with add, subtract, multiply, divide methods"

# Generate data validation
gh workflow run copilot-feature-dev.yml \
  -f feature_prompt="Create a function to validate email addresses using regex"

# Generate API client
gh workflow run copilot-feature-dev.yml \
  -f feature_prompt="Create a REST API client for weather data with error handling"
```

### Copilot Q&A Workflow

Ask questions and get answers committed to the repository:

```bash
gh workflow run copilot-qa.yml \
  -f question="How do I implement OAuth 2.0 authentication in Python?"
```

**What it does:**
1. Sends your question to GitHub Copilot CLI
2. Saves the response to `response.md` in the root directory
3. Archives a timestamped copy in `responses/` directory
4. Commits both files to the repository
5. Makes response available as downloadable artifact

**Response saved to:**
- `response.md` - Latest response (overwritten each time)
- `responses/response_YYYYMMDD_HHMMSS.md` - Archived copy with timestamp

**Example questions:**
```bash
# Ask about implementation
gh workflow run copilot-qa.yml \
  -f question="How do I implement rate limiting in Python using decorators?"

# Ask about best practices
gh workflow run copilot-qa.yml \
  -f question="What are the best practices for error handling in REST APIs?"

# Ask for code examples
gh workflow run copilot-qa.yml \
  -f question="Show me how to implement a simple caching system in Python"
```

### Copilot Agent with GitHub App (Recommended for CI/CD)

ğŸ¯ **Use GitHub App for production-grade automation:**

**Prerequisites:** Complete [GitHub App Setup Guide](docs/github-app-setup.md)

```bash
# Create a feature with Copilot Agent
gh workflow run copilot-agent-github-app.yml \
  -f task_description="Create a Python function to parse and validate JSON schemas"

# Generate tests
gh workflow run copilot-agent-github-app.yml \
  -f task_description="Add unit tests for the authentication module"

# Refactor code
gh workflow run copilot-agent-github-app.yml \
  -f task_description="Refactor the database connection code to use connection pooling"
```

**Why use GitHub App:**
- âœ… Works with `gh agent-task` (requires OAuth token)
- âœ… Secure, scoped permissions
- âœ… Short-lived tokens (1 hour)
- âœ… Better for CI/CD automation
- âœ… Audit trail for all actions

**What it does:**
1. Generates GitHub App installation token
2. Runs `gh agent-task create` with your description
3. Copilot creates a PR and works autonomously
4. Commits code as it progresses
5. Adds you as reviewer when complete

ğŸ“– **Full documentation:** [docs/github-app-setup.md](docs/github-app-setup.md)

### Legacy Copilot Query Workflow

Ask questions and get answers saved as markdown:

```bash
gh workflow run copilot-query.yml \
  -f prompt="How do I implement OAuth 2.0 authentication in Python?"
```

**Response saved to:** `copilot_response.md` (available as artifact)

## ğŸ“ Generated Files Structure

```
generated/
â”œâ”€â”€ create_a_calculator_class_with_add_subtract_multi_1760685544.py
â”œâ”€â”€ create_a_function_to_validate_email_addresses_u_1760685724.py
â””â”€â”€ create_a_function_to_calculate_fibonacci_numbers_1760687827.py
```

Each file contains:
- Complete, production-ready Python code
- Type hints and docstrings
- Error handling
- Unit tests (when applicable)

## ğŸ”§ Workflows

### 1. `copilot-feature-dev.yml` - Code Generation
**Trigger:** Manual (`workflow_dispatch`)

**Inputs:**
- `feature_prompt`: Natural language description of what to build

**Outputs:**
- New feature branch (`feature/copilot-<timestamp>`)
- Generated Python code in `generated/` directory
- Pull request with code review checklist

**Example:**
```bash
gh workflow run copilot-feature-dev.yml \
  -f feature_prompt="Create a binary search tree implementation"
```

### 2. `copilot-qa.yml` - Interactive Q&A
**Trigger:** Manual (`workflow_dispatch`)

**Inputs:**
- `question`: Any question or request for Copilot

**Outputs:**
- `response.md`: Latest answer in root directory (committed to repo)
- `responses/response_YYYYMMDD_HHMMSS.md`: Archived timestamped copy
- Downloadable artifact with the response

**Example:**
```bash
gh workflow run copilot-qa.yml \
  -f question="Explain async/await in Python with examples"
```

### 3. `copilot-query.yml` - Documentation Query (Legacy)
**Trigger:** Manual (`workflow_dispatch`)

**Inputs:**
- `prompt`: Question or documentation query
- `search_docs`: Include Microsoft Docs search (boolean)

**Outputs:**
- `copilot_response.md`: Markdown file with Copilot's answer (artifact only)

### 4. `ai-code-review.yml` - Code Review
**Trigger:** Manual (`workflow_dispatch`)

**Performs:**
- Analyzes git diff
- Provides AI-powered code review comments
- Suggests improvements and best practices

## ğŸ“Š Example Output

### Generated Code Quality

The workflow generates professional code with:

```python
def is_prime(n: Union[int, float]) -> bool:
    """
    Check if a number is prime.
    
    Args:
        n: The number to check. Can be int or float.
        
    Returns:
        bool: True if prime, False otherwise.
        
    Raises:
        TypeError: If n cannot be converted to integer.
        ValueError: If n is negative.
    """
    # Implementation with edge cases and validation
    ...
```

### Pull Request Template

Every PR includes:
- ğŸ¤– AI-Generated Feature badge
- Original prompt
- Generated file path
- Link to workflow run
- Code review checklist

## ğŸ¯ Use Cases

1. **Rapid Prototyping**: Quickly generate boilerplate code for new features
2. **Learning Tool**: See how Copilot implements common patterns
3. **Code Generation Pipeline**: Integrate into existing SDLC workflows
4. **Documentation Assistant**: Query technical documentation on-demand
5. **Code Review Automation**: Get AI-powered code review suggestions

## ğŸ” Validation

The repository includes `@action-validator/cli` for YAML syntax checking:

```bash
npm install -g @action-validator/cli
action-validator .github/workflows/copilot-feature-dev.yml
```

## ğŸ¤ Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

## ğŸ“ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## ğŸ™ Acknowledgments

- [GitHub Copilot](https://github.com/features/copilot) - AI pair programmer
- [GitHub Actions](https://github.com/features/actions) - CI/CD platform
- [@github/copilot](https://www.npmjs.com/package/@github/copilot) - Copilot CLI

## ğŸ“š Additional Resources

- [GitHub Copilot Documentation](https://docs.github.com/en/copilot)
- [GitHub Actions Documentation](https://docs.github.com/en/actions)
- [GitHub CLI Documentation](https://cli.github.com/manual/)

## ğŸ› Troubleshooting

### Workflow fails with "COPILOT_TOKEN not found"
- Ensure you've created a PAT with Copilot scope
- Add it as a secret named `COPILOT_TOKEN` in repository settings

### PR creation fails
- Check that "Allow GitHub Actions to create and approve pull requests" is enabled
- Verify workflow has `pull-requests: write` permission

### Labels not found
- Run the label creation commands from Setup section
- Or remove `--label` flags from workflow

---

Made with â¤ï¸ using GitHub Copilot CLI